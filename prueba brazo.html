<!DOCTYPE html>
<html>
	<head lang="en">
		<meta charset="utf-8">
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
		</style>
		<script src="https://cdn.jsdelivr.net/npm/three@0.126.1/build/three.min.js"></script>
	</head>
	<body>
	
	
		<script type="module" >
var scene = new THREE.Scene();


// Camera
var aspect = window.innerWidth / window.innerHeight;
var camera = new THREE.PerspectiveCamera( 60, aspect, 0.1, 1000 );
camera.position.z = -2.5;
camera.position.x = -5;
camera.position.y = 5;
camera.lookAt(0, 1.5, 0);
let a1 =0.2;
let a2 =0.5;
let a3 =4;
const results = [];
camera.updateProjectionMatrix();
// var controls = new THREE.OrbitControls( camera );


// Renderer
var renderer = new THREE.WebGLRenderer({antialias: true});
renderer.setSize( window.innerWidth, window.innerHeight );
document.body.appendChild( renderer.domElement );


// Model: 
var material = new THREE.MeshStandardMaterial();
var geometry = new THREE.BoxGeometry( 2, 0.2, 2 );
//var material = new THREE.MeshBasicMaterial({
	//color: 0x00ff00,
	//wireframe: true, 
//});

var material = new THREE.MeshStandardMaterial({ color: 0x8B4513 }); // 0x8B4513 es el código de color para el tono de café madera.

var base = new THREE.Mesh( geometry, material );
scene.add( base );


var geometry = new THREE.BoxGeometry( 2, 1, a1);
var base1 = new THREE.Mesh( geometry, material );
base1.translateY(0.5);
base1.translateZ(1);
base.add( base1 );


var geometry = new THREE.BoxGeometry( 0.2, 0.5, 1.82 );
var base2 = new THREE.Mesh( geometry, material );
base2.translateY(0.5);
base2.translateX(1);
base2.translateZ(-0.05);
base.add( base2 );

var geometry = new THREE.BoxGeometry( 0.2, 0.5, 1.82 );
var base3 = new THREE.Mesh( geometry, material );
base3.translateY(0.5);
base3.translateX(-1);
base3.translateZ(-0.05);
base.add( base3 );

var geometry = new THREE.BoxGeometry( 2, 1, a1, 2 );
var base4 = new THREE.Mesh( geometry, material );
base4.translateY(0.5);
base4.translateZ(-1.1);
base.add( base4 );


var geometry = new THREE.BoxGeometry ( 0.5, 3, 0.1);
var shoulder = new THREE.Mesh(geometry, material);
shoulder.translateZ(-0.95);
shoulder.translateY(2);
shoulder.translateX(0.3);
base.add(shoulder);


var geometry = new THREE.BoxGeometry ( 0.5, 3, 0.1);
var shoulder1 = new THREE.Mesh(geometry, material);
shoulder1.translateZ(0.85);
shoulder1.translateY(2);
shoulder1.translateX(0.3);
base.add(shoulder1);


var geometry = new THREE.BoxGeometry ( 0.5, 3, 0.1);
var shoulder2 = new THREE.Mesh(geometry, material);
shoulder2.translateZ(0.85);
shoulder2.translateY(2);
shoulder2.translateX(-0.6);
base.add(shoulder2);


var geometry = new THREE.BoxGeometry ( 0.5, 3, 0.1);
var shoulder3 = new THREE.Mesh(geometry, material);
shoulder3.translateZ(-0.95);
shoulder3.translateY(2);
shoulder3.translateX(-0.6);
base.add(shoulder3);

var geometry = new THREE.BoxGeometry ( 4, 0.3, 0.1);
var lowerarm = new THREE.Mesh(geometry, material);
lowerarm.translateZ(-0.95);
lowerarm.translateY(3.6);
lowerarm.translateX(1.1);
base.add(lowerarm);


var geometry = new THREE.BoxGeometry ( 4, 0.3, 0.1);
var lowerarm1 = new THREE.Mesh(geometry, material);
lowerarm1.translateZ(0.85);
lowerarm1.translateY(3.6);
lowerarm1.translateX(1.1);
base.add(lowerarm1);

var geometry = new THREE.BoxGeometry (2.1, 0.2, 1.8);
var basem = new THREE.Mesh(geometry, material);
basem.translateZ(0);
basem.translateY(3.4);
basem.translateX(3);
base.add(basem);


var geometry = new THREE.BoxGeometry (1.82, 0.2, 0.4);
var hand1 = new THREE.Mesh(geometry, material);
hand1.translateZ(-0.7);
hand1.translateY(3.4);
hand1.translateX(4.75);
base.add(hand1);

var geometry = new THREE.BoxGeometry (1.82, 0.2, 0.4);
var hand2 = new THREE.Mesh(geometry, material);
hand2.translateZ(0.7);
hand2.translateY(3.4);
hand2.translateX(4.75);
base.add(hand2);

var material = new THREE.MeshStandardMaterial({ color: 0xC0C0C0});


var screw1 = new THREE.Object3D();
screw1.translateZ(0.8);
screw1.translateY(0.9);
screw1.translateX(0.3);
base1.add(screw1);

var screw2 = new THREE.Object3D();
screw2.translateZ(0.8);
screw2.translateY(0.9);
screw2.translateX(-0.6);
base1.add(screw2);

var screw3 = new THREE.Object3D();
screw3.translateZ(-1.2);
screw3.translateY(0.9);
screw3.translateX(0.3);
base4.add(screw3);

var screw4 = new THREE.Object3D();
screw4.translateZ(-1.2);
screw4.translateY(0.9);
screw4.translateX(-0.6);
base4.add(screw4);


var screw5 = new THREE.Object3D();
screw5.translateZ(0.8);
screw5.translateY(3.59);
screw5.translateX(0.3);
shoulder1.add(screw5);

var screw6 = new THREE.Object3D();
screw6.translateZ(0.8);
screw6.translateY(3.59);
screw6.translateX(-0.6);
shoulder2.add(screw6);

var screw7 = new THREE.Object3D();
screw7.translateZ(-1);
screw7.translateY(3.59);
screw7.translateX(0.3);
shoulder.add(screw7);

var screw8 = new THREE.Object3D();
screw8.translateZ(-1);
screw8.translateY(3.59);
screw8.translateX(-0.6);
shoulder3.add(screw8);

var screw9= new THREE.Object3D();
screw9.translateZ(-1.);
screw9.translateY(3.54);
screw9.translateX(1.5);
basem.add(screw9);

// Light
var light = new THREE.DirectionalLight(0xffffff, 1.0);
light.position.set(10, 5, 10);
light.target = base;
scene.add(light);

light = new THREE.AmbientLight(0xffffff, 0.5);
scene.add(light);



        let th1R, th2R, th3R;

        const P = new THREE.Vector3((1) / 2, (1) / 2, (1) / 2);
        const Q = new THREE.Vector3((1) + (1 / 2), (1) / 2, (1) + (1	 / 2));

        function moveArmToPoints(P, xAxis) {
            results.length = 0;
            for (let i = 0; i <= 60; i++) {
                const t = i / 60;
                const x03 = (1 - t) * P.x + t * Q.x;
                const y03 = (1 - t) * P.y + t * Q.y;
                const z03 = (1 - t) * P.z + t * Q.z;

                const th1 = Math.atan2(z03, x03);
                const r1 = Math.sqrt(x03 ** 2 + z03 ** 2);
                const r2 = (y03 - a1);
                const phi2 = Math.atan2(r2, r1);
                const r3 = Math.sqrt(r1 ** 2 + r2 ** 2);
                const phi1 = Math.acos((a3 ** 2 - a2 ** 2 - r3 ** 2) / (-2 * a2 * r3));
                const th2 = (phi2 - phi1);
                const phi3 = Math.acos((r3 ** 2 - a2 ** 2 - a3 ** 2) / (-2 * a2 * a3));
                const th3 = 3.1416 - phi3;

                results.push({
                    th1,
                    th2,
                    th3
                });
            }

            th1R = (results[0].th1);
            th2R = (results[0].th2);
            th3R = (results[0].th3);
        }

// Rendering
var xAxis = new THREE.Vector3(1,0,0);
var zAxis = new THREE.Vector3(0, 0, 1);
var yAxis = new THREE.Vector3(0, 1, 0);

var GAMMA1=30
var X1= 45


var render = function () {
  requestAnimationFrame( render );
	const factor = Math.floor((Date.now() / 100) % 60);
            th1R = results[factor].th1;
            th2R = results[factor].th2;
            th3R = results[factor].th3;

 	screw1.setRotationFromAxisAngle(yAxis, th2R);	
	screw2.setRotationFromAxisAngle(yAxis, th2R);
	screw3.setRotationFromAxisAngle(yAxis, th2R);
	screw4.setRotationFromAxisAngle(yAxis, th2R);
	screw5.setRotationFromAxisAngle(zAxis, th3R);	
	screw6.setRotationFromAxisAngle(zAxis, th3R);
	screw7.setRotationFromAxisAngle(zAxis, th3R);
	screw8.setRotationFromAxisAngle(zAxis, th3R);
        

  renderer.render( scene, camera );
};

render();
		</script>
	</body>
</html>
